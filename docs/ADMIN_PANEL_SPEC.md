# Админ-панель Afisha.kz — Спецификация

**Версия:** 1.0
**Дата:** Январь 2026
**Роли:** Product Owner, Business Analyst, UX/UI Engineer

---

## 1. Обзор и цели

### Бизнес-цели админ-панели
- Эффективное управление контентом и пользователями
- Контроль качества размещаемой информации
- Мониторинг монетизации и подписок
- Масштабирование по городам без увеличения штата

### Роли администраторов

| Роль | Права | Описание |
|------|-------|----------|
| **Super Admin** | Полный доступ | Владелец платформы |
| **Admin** | Управление контентом, пользователями | Штатный администратор |
| **Moderator** | Модерация контента | Проверка событий/акций |
| **City Manager** | Управление своим городом | Локальный менеджер |
| **Support** | Только просмотр + ответы | Поддержка пользователей |

---

## 2. Структура админ-панели

```
┌─────────────────────────────────────────────────────────────┐
│  ADMIN PANEL - AFISHA.KZ                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📊 Dashboard (Главная)                                     │
│  👥 Пользователи                                            │
│  🏢 Бизнесы                                                 │
│  📅 События                                                 │
│  🏷️ Акции                                                   │
│  🏙️ Города                                                  │
│  👥 Сообщества                                              │
│  💰 Финансы                                                 │
│  📢 Модерация                                               │
│  📈 Аналитика                                               │
│  ⚙️ Настройки                                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. Детальная спецификация разделов

### 3.1 📊 Dashboard (Главная)

**Цель:** Быстрый обзор состояния платформы за сегодня/неделю/месяц

#### KPI-карточки (верхняя панель)
```
┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│ Пользователи │ │   Бизнесы    │ │   События    │ │    Доход     │
│    12,450    │ │     347      │ │     89       │ │  2.4M ₸      │
│   +124 ↑     │ │    +12 ↑     │ │    +5 ↑      │ │  +180K ↑     │
└──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘
```

#### Графики
- **Регистрации** — линейный график по дням
- **Активность** — MAU/DAU
- **Доход** — по источникам (B2C/B2B/баннеры)
- **География** — распределение по городам

#### Быстрые действия
- [ ] Заявки на верификацию бизнеса (5)
- [ ] Контент на модерации (12)
- [ ] Жалобы пользователей (3)
- [ ] Истекающие подписки (8)

#### Лента активности
```
10:45  Новый бизнес: "Кофейня Арома" (Алматы) — ожидает верификации
10:32  Пользователь @aidar подал жалобу на событие #4521
10:15  Бизнес "ТехноМир" оплатил Premium (200,000 ₸)
09:58  Новое событие: "Концерт Димаша" — на модерации
```

---

### 3.2 👥 Пользователи

#### Таблица пользователей
| Поле | Фильтр | Сортировка |
|------|--------|------------|
| ID | - | ✓ |
| Имя | Поиск | ✓ |
| Email | Поиск | ✓ |
| Телефон | Поиск | - |
| Роль | user/business/moderator/admin | ✓ |
| Город | Выпадающий список | ✓ |
| Подписка | free/premium | ✓ |
| Статус | active/blocked/pending | ✓ |
| Дата регистрации | Диапазон дат | ✓ |
| Последняя активность | Диапазон дат | ✓ |

#### Действия с пользователем
- **Просмотр профиля** — полная информация
- **Редактировать** — изменить данные
- **Сменить роль** — повысить/понизить
- **Управление подпиской** — выдать/отменить Premium
- **Заблокировать** — с указанием причины
- **Удалить** — soft delete с архивацией
- **Написать** — отправить уведомление
- **История действий** — лог активности

#### Карточка пользователя
```
┌─────────────────────────────────────────────────────────────┐
│  👤 Айдар Касымов                              [Активен] ✓  │
├─────────────────────────────────────────────────────────────┤
│  Email: aidar@example.com                                   │
│  Телефон: +7 777 123 45 67                                  │
│  Город: Алматы                                              │
│  Роль: Пользователь                                         │
│  Подписка: Premium (до 15.02.2026)                          │
│  Зарегистрирован: 10.01.2026                                │
│  Последний визит: Сегодня, 10:45                            │
├─────────────────────────────────────────────────────────────┤
│  📊 Статистика                                              │
│  • Избранных событий: 23                                    │
│  • Использовано акций: 15                                   │
│  • Сообществ: 3                                             │
│  • Жалоб: 0                                                 │
├─────────────────────────────────────────────────────────────┤
│  [Редактировать] [Написать] [Заблокировать] [Удалить]       │
└─────────────────────────────────────────────────────────────┘
```

---

### 3.3 🏢 Бизнесы

#### Воронка бизнесов
```
Заявки → Верификация → Активные → Платящие
  45   →     12      →   320    →    87
```

#### Таблица бизнесов
| Поле | Фильтр | Описание |
|------|--------|----------|
| Название | Поиск | - |
| Владелец | Поиск | Связь с пользователем |
| Город | Список | - |
| Категория | Список | Ресторан, Развлечения, etc |
| Тариф | free/lite/premium | - |
| Верификация | pending/verified/rejected | - |
| Публикаций (мес) | Число | Использовано/лимит |
| Рейтинг | 1-5 | Средняя оценка |
| Статус | active/suspended/deleted | - |

#### Карточка бизнеса
```
┌─────────────────────────────────────────────────────────────┐
│  🏢 Ресторан "Тюльпан"                    [Premium] 💎      │
│  ⭐ 4.7 (156 отзывов)                     Верифицирован ✓   │
├─────────────────────────────────────────────────────────────┤
│  📍 Алматы, ул. Абая 150                                    │
│  📞 +7 727 123 45 67                                        │
│  📧 tulpan@restaurant.kz                                    │
│  🌐 instagram.com/tulpan_almaty                             │
├─────────────────────────────────────────────────────────────┤
│  👤 Владелец: Марат Сериков (marat@example.com)             │
│  📅 Зарегистрирован: 05.12.2025                             │
│  💰 Тариф: Premium (200,000 ₸/мес) — до 05.02.2026          │
├─────────────────────────────────────────────────────────────┤
│  📊 Статистика за месяц                                     │
│  • Публикаций: 8 / ∞                                        │
│  • Просмотров: 12,450                                       │
│  • Переходов: 890                                           │
│  • Акций активных: 3                                        │
├─────────────────────────────────────────────────────────────┤
│  📋 Документы                                               │
│  • ИИН/БИН: 123456789012 ✓                                  │
│  • Свидетельство: [Просмотреть]                             │
├─────────────────────────────────────────────────────────────┤
│  [Редактировать] [Сменить тариф] [Приостановить] [Удалить]  │
└─────────────────────────────────────────────────────────────┘
```

#### Верификация бизнеса (workflow)
```
1. Заявка получена
   ↓
2. Проверка документов (ИИН/БИН, свидетельство)
   ↓
3. Проверка контактов (звонок/email)
   ↓
4. Решение: [Одобрить] [Запросить доп. документы] [Отклонить]
   ↓
5. Уведомление владельцу
```

#### Управление тарифами бизнеса
```
┌─────────────────────────────────────────────────────────────┐
│  Сменить тариф для "Ресторан Тюльпан"                       │
├─────────────────────────────────────────────────────────────┤
│  Текущий тариф: Premium (200,000 ₸/мес)                     │
│  Действует до: 05.02.2026                                   │
├─────────────────────────────────────────────────────────────┤
│  ○ Free (0 ₸) — 3 публикации/мес                            │
│  ○ Lite (50,000 ₸) — 10 публикаций/мес                      │
│  ● Premium (200,000 ₸) — безлимит + баннер                  │
├─────────────────────────────────────────────────────────────┤
│  [ ] Продлить на 1 месяц                                    │
│  [ ] Выдать бесплатно (промо)                               │
│  Причина: [________________]                                │
├─────────────────────────────────────────────────────────────┤
│  [Отмена]                              [Применить]          │
└─────────────────────────────────────────────────────────────┘
```

---

### 3.4 📅 События

#### Таблица событий
| Поле | Фильтр |
|------|--------|
| Название | Поиск |
| Бизнес/Организатор | Поиск |
| Город | Список |
| Категория | Концерт, Спорт, Обучение, etc |
| Дата проведения | Диапазон |
| Цена | Бесплатно/Платно, диапазон |
| Статус | draft/moderation/published/rejected/past |
| Featured | Да/Нет |

#### Действия
- **Опубликовать** — одобрить после модерации
- **Отклонить** — с указанием причины
- **Редактировать** — изменить данные
- **Сделать Featured** — показать в "Главные события"
- **Удалить** — soft delete

#### Модерация события
```
┌─────────────────────────────────────────────────────────────┐
│  🎤 Концерт Димаша Кудайбергена              [На модерации] │
├─────────────────────────────────────────────────────────────┤
│  [Изображение события]                                      │
│                                                             │
│  📍 Алматы, Дворец Республики                               │
│  📅 15 июня 2026, 19:00                                     │
│  💰 5,000 - 50,000 ₸                                        │
│  🏷️ Концерт, Музыка                                         │
├─────────────────────────────────────────────────────────────┤
│  Описание:                                                  │
│  Долгожданный концерт Димаша в Алматы! Программа из        │
│  лучших хитов и новых песен...                              │
├─────────────────────────────────────────────────────────────┤
│  Организатор: Premier Events (Premium) ✓                    │
├─────────────────────────────────────────────────────────────┤
│  ⚠️ Чек-лист модерации:                                     │
│  [✓] Название корректное                                    │
│  [✓] Изображение качественное                               │
│  [✓] Дата и время указаны                                   │
│  [✓] Место проведения существует                            │
│  [✓] Цены адекватные                                        │
│  [✓] Нет запрещенного контента                              │
├─────────────────────────────────────────────────────────────┤
│  Комментарий модератора: [________________________]         │
├─────────────────────────────────────────────────────────────┤
│  [Отклонить]              [Запросить правки]   [Одобрить]   │
└─────────────────────────────────────────────────────────────┘
```

---

### 3.5 🏷️ Акции

#### Таблица акций
| Поле | Фильтр |
|------|--------|
| Название | Поиск |
| Бизнес | Поиск |
| Город | Список |
| Скидка | Диапазон % |
| Период действия | Даты |
| Тип | Для всех / Premium only |
| Использований | Число |
| Статус | active/expired/draft |

#### Управление акциями
- Массовое одобрение/отклонение
- Продление срока действия
- Изменение типа (free ↔ premium)
- Статистика использования

---

### 3.6 🏙️ Города

#### Управление городами
```
┌─────────────────────────────────────────────────────────────┐
│  🏙️ Города платформы                                        │
├─────────────────────────────────────────────────────────────┤
│  [+ Добавить город]                                         │
├──────────────────────────────────────────────────────────────┤
│  Город        │ Slug      │ Бизнесов │ Событий │ Статус    │
├──────────────────────────────────────────────────────────────┤
│  Алматы       │ almaty    │    156   │    45   │ ✅ Активен │
│  Астана       │ astana    │    124   │    38   │ ✅ Активен │
│  Шымкент      │ shymkent  │     67   │    12   │ ✅ Активен │
│  Караганда    │ karaganda │     34   │     8   │ ✅ Активен │
│  Жезказган    │ jezkazgan │     12   │     3   │ ✅ Активен │
│  Актау        │ aktau     │      0   │     0   │ ⏸️ Скрыт   │
│  ...          │           │          │         │            │
└──────────────────────────────────────────────────────────────┘
```

#### Настройки города
- **Название** (RU/KZ)
- **Slug** (URL)
- **Регион**
- **Население** (для приоритизации)
- **Статус** (активен/скрыт)
- **City Manager** (назначить менеджера)
- **Баннеры** (локальные рекламодатели)

---

### 3.7 💰 Финансы

#### Обзор доходов
```
┌─────────────────────────────────────────────────────────────┐
│  💰 Финансы — Январь 2026                                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Общий доход:        2,450,000 ₸                            │
│  ├── B2C Premium:      450,000 ₸  (18%)                     │
│  ├── B2B Lite:         600,000 ₸  (25%)                     │
│  ├── B2B Premium:    1,200,000 ₸  (49%)                     │
│  └── Баннеры:          200,000 ₸  (8%)                      │
│                                                             │
│  [График по дням]                                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### Таблица транзакций
| Дата | Тип | Плательщик | Сумма | Статус |
|------|-----|------------|-------|--------|
| 17.01 | B2B Premium | ТОО "Ресторан Тюльпан" | 200,000 ₸ | ✅ Оплачено |
| 17.01 | B2C Premium | Айдар К. | 2,000 ₸ | ✅ Оплачено |
| 16.01 | B2B Lite | ИП Сериков | 50,000 ₸ | ⏳ Ожидает |

#### Управление подписками
- Список активных подписок
- Истекающие подписки (напоминания)
- Отмененные подписки (churn analysis)
- Ручное продление/отмена
- Промо-коды и скидки

---

### 3.8 📢 Модерация

#### Очередь модерации
```
┌─────────────────────────────────────────────────────────────┐
│  📢 Модерация                                               │
├─────────────────────────────────────────────────────────────┤
│  📅 События на проверке:     12                             │
│  🏷️ Акции на проверке:        5                             │
│  🏢 Бизнесы на верификации:   8                             │
│  ⚠️ Жалобы:                    3                             │
└─────────────────────────────────────────────────────────────┘
```

#### Жалобы пользователей
| Дата | От кого | На что | Тип жалобы | Статус |
|------|---------|--------|------------|--------|
| 17.01 | @aidar | Событие #4521 | Мошенничество | 🔴 Новая |
| 16.01 | @marat | Бизнес "ТехноМир" | Спам | 🟡 В работе |
| 15.01 | @dana | Комментарий #789 | Оскорбление | ✅ Решена |

#### Типы жалоб
- Мошенничество
- Спам
- Неактуальная информация
- Оскорбительный контент
- Нарушение авторских прав
- Другое

#### Workflow жалобы
```
1. Жалоба получена → Уведомление модератору
2. Модератор изучает контент
3. Решение:
   - Отклонить жалобу (контент OK)
   - Удалить контент
   - Предупреждение владельцу
   - Блокировка владельца
4. Уведомление заявителю о решении
```

---

### 3.9 📈 Аналитика

#### Дашборды
1. **Пользователи**
   - Регистрации по дням/источникам
   - Retention (D1, D7, D30)
   - Конверсия Free → Premium
   - География пользователей

2. **Бизнесы**
   - Воронка: заявка → верификация → активность
   - Конверсия по тарифам
   - Churn rate
   - Топ бизнесов по активности

3. **Контент**
   - События по категориям
   - Популярные события (просмотры)
   - Акции по использованию

4. **Финансы**
   - MRR/ARR
   - ARPU
   - LTV
   - Revenue по городам

#### Экспорт отчетов
- CSV/Excel
- По периоду
- По городу
- По типу данных

---

### 3.10 ⚙️ Настройки

#### Общие настройки
- Название платформы
- Логотип и брендинг
- Контакты поддержки
- Юридическая информация

#### Тарифы
```
┌─────────────────────────────────────────────────────────────┐
│  💳 Настройки тарифов                                       │
├─────────────────────────────────────────────────────────────┤
│  B2C Premium                                                │
│  • Цена: [1,500] - [2,000] ₸/мес                            │
│  • Функции: [✓] Все акции [✓] QR-коды [✓] Без рекламы      │
├─────────────────────────────────────────────────────────────┤
│  B2B Free                                                   │
│  • Цена: 0 ₸                                                │
│  • Лимит публикаций: [3] /мес                               │
├─────────────────────────────────────────────────────────────┤
│  B2B Lite                                                   │
│  • Цена: [50,000] ₸/мес                                     │
│  • Лимит публикаций: [10] /мес                              │
├─────────────────────────────────────────────────────────────┤
│  B2B Premium                                                │
│  • Цена: [200,000] ₸/мес                                    │
│  • Лимит публикаций: Безлимит                               │
│  • Функции: [✓] Баннер [✓] Приоритет в выдаче              │
└─────────────────────────────────────────────────────────────┘
```

#### Категории
- Управление категориями событий
- Управление категориями бизнесов
- Иконки и цвета

#### Уведомления
- Шаблоны email
- Push-уведомления
- SMS (при необходимости)

#### Администраторы
- Список админов/модераторов
- Приглашение новых
- Управление правами
- Лог действий админов

---

## 4. UX/UI Рекомендации

### Принципы дизайна
1. **Минимум кликов** — частые действия доступны сразу
2. **Контекстные действия** — кнопки там, где нужны
3. **Bulk operations** — массовые действия для списков
4. **Keyboard shortcuts** — горячие клавиши для модераторов
5. **Mobile-friendly** — адаптив для управления на ходу

### Цветовая схема статусов
- 🟢 Зеленый — активно, одобрено
- 🟡 Желтый — ожидает действия
- 🔴 Красный — требует внимания
- ⚫ Серый — неактивно, архив

### Уведомления в админке
```
┌─────────────────────────────────────┐
│ 🔔 Уведомления                  (5) │
├─────────────────────────────────────┤
│ • Новая заявка на верификацию       │
│ • 3 события ожидают модерации       │
│ • Жалоба на бизнес "ТехноМир"       │
│ • Подписка Premium истекает (5)     │
│ • Ежедневный отчет готов            │
└─────────────────────────────────────┘
```

---

## 5. API Endpoints для админки

### Аутентификация
```
POST /admin/auth/login
POST /admin/auth/logout
GET  /admin/auth/me
```

### Dashboard
```
GET /admin/dashboard/stats
GET /admin/dashboard/activity
GET /admin/dashboard/alerts
```

### Пользователи
```
GET    /admin/users
GET    /admin/users/:id
PUT    /admin/users/:id
DELETE /admin/users/:id
POST   /admin/users/:id/block
POST   /admin/users/:id/subscription
```

### Бизнесы
```
GET    /admin/businesses
GET    /admin/businesses/:id
PUT    /admin/businesses/:id
DELETE /admin/businesses/:id
POST   /admin/businesses/:id/verify
POST   /admin/businesses/:id/tier
```

### Модерация
```
GET  /admin/moderation/queue
POST /admin/moderation/events/:id/approve
POST /admin/moderation/events/:id/reject
GET  /admin/moderation/complaints
POST /admin/moderation/complaints/:id/resolve
```

### Аналитика
```
GET /admin/analytics/users
GET /admin/analytics/revenue
GET /admin/analytics/content
GET /admin/analytics/export
```

---

## 6. MVP vs Full версия

### MVP админки (Phase 1)
- [x] Dashboard с основными метриками
- [x] Список пользователей + блокировка
- [x] Список бизнесов + верификация
- [x] Модерация событий/акций
- [x] Управление городами

### Full версия (Phase 2)
- [ ] Расширенная аналитика
- [ ] Финансовые отчеты
- [ ] Промо-коды и скидки
- [ ] Роли и права доступа
- [ ] Аудит лог
- [ ] Email-рассылки
- [ ] A/B тесты

---

## 7. Технические требования

### Стек
- **Frontend:** React + TypeScript + Tailwind + shadcn/ui
- **Routing:** React Router с защитой роутов
- **State:** TanStack Query + Zustand
- **Charts:** Recharts или Chart.js
- **Tables:** TanStack Table (сортировка, фильтры, пагинация)

### Безопасность
- JWT токены с коротким сроком жизни
- Refresh tokens
- RBAC (Role-Based Access Control)
- Rate limiting
- Audit log всех действий

### Производительность
- Виртуализация длинных списков
- Кэширование данных
- Оптимистичные обновления
- Пагинация на сервере

---

*Документ подготовлен: Product Owner, Business Analyst, UX/UI Engineer*
*Дата: 17 января 2026*
